{"version":3,"file":"AuthWithOAuth2Docs-DrgIgEst.js","sources":["../../src/components/collections/docs/AuthWithOAuth2Docs.svelte"],"sourcesContent":["<script>\n    import CodeBlock from \"@/components/base/CodeBlock.svelte\";\n    import FieldsQueryParam from \"@/components/collections/docs/FieldsQueryParam.svelte\";\n    import SdkTabs from \"@/components/base/SdkTabs.svelte\";\n    import ApiClient from \"@/utils/ApiClient\";\n    import CommonHelper from \"@/utils/CommonHelper\";\n\n    export let collection;\n\n    let responseTab = 200;\n    let responses = [];\n\n    $: backendAbsUrl = CommonHelper.getApiExampleUrl(ApiClient.baseURL);\n\n    $: responses = [\n        {\n            code: 200,\n            body: JSON.stringify(\n                {\n                    token: \"JWT_AUTH_TOKEN\",\n                    record: CommonHelper.dummyCollectionRecord(collection),\n                    meta: {\n                        id: \"abc123\",\n                        name: \"John Doe\",\n                        username: \"john.doe\",\n                        email: \"test@example.com\",\n                        avatarURL: \"https://example.com/avatar.png\",\n                        accessToken: \"...\",\n                        refreshToken: \"...\",\n                        expiry: \"2022-01-01 10:00:00.123Z\",\n                        isNew: false,\n                        rawUser: {},\n                    },\n                },\n                null,\n                2,\n            ),\n        },\n        {\n            code: 400,\n            body: `\n                {\n                  \"status\": 400,\n                  \"message\": \"An error occurred while submitting the form.\",\n                  \"data\": {\n                    \"provider\": {\n                      \"code\": \"validation_required\",\n                      \"message\": \"Missing required value.\"\n                    }\n                  }\n                }\n            `,\n        },\n    ];\n</script>\n\n<h3 class=\"m-b-sm\">Auth with OAuth2 ({collection.name})</h3>\n<div class=\"content txt-lg m-b-sm\">\n    <p>Authenticate with an OAuth2 provider and returns a new auth token and record data.</p>\n    <p>\n        For more details please check the\n        <a href={import.meta.env.PB_OAUTH2_EXAMPLE} target=\"_blank\" rel=\"noopener noreferrer\">\n            OAuth2 integration documentation\n        </a>.\n    </p>\n</div>\n\n<SdkTabs\n    js={`\n        import PocketBase from 'pocketbase';\n\n        const pb = new PocketBase('${backendAbsUrl}');\n\n        ...\n\n        // OAuth2 authentication with a single realtime call.\n        //\n        // Make sure to register ${backendAbsUrl}/api/oauth2-redirect as redirect url.\n        const authData = await pb.collection('${collection.name}').authWithOAuth2({ provider: 'google' });\n\n        // OR authenticate with manual OAuth2 code exchange\n        // const authData = await pb.collection('${collection.name}').authWithOAuth2Code(...);\n\n        // after the above you can also access the auth data from the authStore\n        console.log(pb.authStore.isValid);\n        console.log(pb.authStore.token);\n        console.log(pb.authStore.record.id);\n\n        // \"logout\"\n        pb.authStore.clear();\n    `}\n    dart={`\n        import 'package:pocketbase/pocketbase.dart';\n        import 'package:url_launcher/url_launcher.dart';\n\n        final pb = PocketBase('${backendAbsUrl}');\n\n        ...\n\n        // OAuth2 authentication with a single realtime call.\n        //\n        // Make sure to register ${backendAbsUrl}/api/oauth2-redirect as redirect url.\n        final authData = await pb.collection('${collection.name}').authWithOAuth2('google', (url) async {\n          await launchUrl(url);\n        });\n\n        // OR authenticate with manual OAuth2 code exchange\n        // final authData = await pb.collection('${collection.name}').authWithOAuth2Code(...);\n\n        // after the above you can also access the auth data from the authStore\n        print(pb.authStore.isValid);\n        print(pb.authStore.token);\n        print(pb.authStore.record.id);\n\n        // \"logout\"\n        pb.authStore.clear();\n    `}\n/>\n\n<h6 class=\"m-b-xs\">API details</h6>\n<div class=\"alert alert-success\">\n    <strong class=\"label label-primary\">POST</strong>\n    <div class=\"content\">\n        <p>\n            /api/collections/<strong>{collection.name}</strong>/auth-with-oauth2\n        </p>\n    </div>\n</div>\n\n<div class=\"section-title\">Body Parameters</div>\n<table class=\"table-compact table-border m-b-base\">\n    <thead>\n        <tr>\n            <th>Param</th>\n            <th>Type</th>\n            <th width=\"50%\">Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>\n                <div class=\"inline-flex\">\n                    <span class=\"label label-success\">Required</span>\n                    <span>provider</span>\n                </div>\n            </td>\n            <td>\n                <span class=\"label\">String</span>\n            </td>\n            <td>The name of the OAuth2 client provider (eg. \"google\").</td>\n        </tr>\n        <tr>\n            <td>\n                <div class=\"inline-flex\">\n                    <span class=\"label label-success\">Required</span>\n                    <span>code</span>\n                </div>\n            </td>\n            <td>\n                <span class=\"label\">String</span>\n            </td>\n            <td>The authorization code returned from the initial request.</td>\n        </tr>\n        <tr>\n            <td>\n                <div class=\"inline-flex\">\n                    <span class=\"label label-success\">Required</span>\n                    <span>codeVerifier</span>\n                </div>\n            </td>\n            <td>\n                <span class=\"label\">String</span>\n            </td>\n            <td>The code verifier sent with the initial request as part of the code_challenge.</td>\n        </tr>\n        <tr>\n            <td>\n                <div class=\"inline-flex\">\n                    <span class=\"label label-success\">Required</span>\n                    <span>redirectURL</span>\n                </div>\n            </td>\n            <td>\n                <span class=\"label\">String</span>\n            </td>\n            <td>The redirect url sent with the initial request.</td>\n        </tr>\n        <tr>\n            <td>\n                <div class=\"inline-flex\">\n                    <span class=\"label label-warning\">Optional</span>\n                    <span>createData</span>\n                </div>\n            </td>\n            <td>\n                <span class=\"label\">Object</span>\n            </td>\n            <td>\n                <p>Optional data that will be used when creating the auth record on OAuth2 sign-up.</p>\n                <p>\n                    The created auth record must comply with the same requirements and validations in the\n                    regular <strong>create</strong> action.\n                    <br />\n                    <em>\n                        The data can only be in <code>json</code>, aka. <code>multipart/form-data</code> and files\n                        upload currently are not supported during OAuth2 sign-ups.\n                    </em>\n                </p>\n            </td>\n        </tr>\n    </tbody>\n</table>\n\n<div class=\"section-title\">Query parameters</div>\n<table class=\"table-compact table-border m-b-base\">\n    <thead>\n        <tr>\n            <th>Param</th>\n            <th>Type</th>\n            <th width=\"60%\">Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>expand</td>\n            <td>\n                <span class=\"label\">String</span>\n            </td>\n            <td>\n                Auto expand record relations. Ex.:\n                <CodeBlock content={`?expand=relField1,relField2.subRelField`} />\n                Supports up to 6-levels depth nested relations expansion. <br />\n                The expanded relations will be appended to the record under the\n                <code>expand</code> property (eg. <code>{`\"expand\": {\"relField1\": {...}, ...}`}</code>).\n                <br />\n                Only the relations to which the request user has permissions to <strong>view</strong> will be expanded.\n            </td>\n        </tr>\n        <FieldsQueryParam prefix=\"record.\" />\n    </tbody>\n</table>\n\n<div class=\"section-title\">Responses</div>\n<div class=\"tabs\">\n    <div class=\"tabs-header compact combined left\">\n        {#each responses as response (response.code)}\n            <button\n                class=\"tab-item\"\n                class:active={responseTab === response.code}\n                on:click={() => (responseTab = response.code)}\n            >\n                {response.code}\n            </button>\n        {/each}\n    </div>\n    <div class=\"tabs-content\">\n        {#each responses as response (response.code)}\n            <div class=\"tab-item\" class:active={responseTab === response.code}>\n                <CodeBlock content={response.body} />\n            </div>\n        {/each}\n    </div>\n</div>\n"],"names":["t0_value","ctx","insert","target","button","anchor","dirty","set_data","t0","div","codeblock_changes","t1_value","t16_value","get_key","i","get_key_1","h3","div0","h6","div2","append","strong0","div1","p2","strong1","div3","table0","div9","table1","thead1","tbody1","tr7","td15","td16","td17","br1","code2","code3","br2","strong3","div10","div13","div11","div12","current","t1","t16","collection","$$props","responseTab","responses","response","CommonHelper","backendAbsUrl","ApiClient"],"mappings":"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"}